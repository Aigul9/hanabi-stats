# Hanabi stats

The program parses users' statistics from https://hanab.live/, calculates percentage of winnings and losings for each type of variants (easy, single dark, double dark, easy null variants which are neither single nor double dark), filters it by each player, gets highest winrate and saves all statistics to the files in tsv format.

Last available results can be found here: [click](https://github.com/Aigul9/hanabi-stats/blob/master/output) (22/04/2021).<br/>

## Stack of technologies
- [Python 3.9](https://www.python.org/)

## Folders structure
- ```input```: data which should be provided to the program;
- ```output```: results;
- ```py```: python scripts to download and parse statistics, calculate user data;
- ```resources```: list of available variants and their efficiency;
- ```temp```: temporary files generated by the program. Files ```[username]_stats.txt``` and ```[username]_players.txt``` contain table of games and list of players respectively.

## Output content
- ```filtered_by_players```: list of teammates sorted by win/loss ratio with at least 20 games in total;
- ```highest_wr_all.tsv```: total winrate;
- ```highest_wr_bga.tsv```: statistics for bga variants;
- ```highest_wr_not_bga.tsv```: statistics for non-speedrun variants;
- ```rank.tsv```: global hanabi rank ([see below](#rank-calculation-algorithm)) and lists of top 5 / bottom 5 teammates;
- ```up_to_date_stats.tsv```: total statistics group by variant types.

## Types of variants

BGA variants:
- No Variant
- 6 Suits
- Rainbow (6 Suits)

Speedrun variants:
- BGA variants
- Black (6 Suits)
- Dark Rainbow (6 Suits)
- White Reversed (6 Suits)

## Rank calculation algorithm
1. Exclude speedrun and double dark variants.
2. Exclude teammates with less than 100 games.
3. Sort the list by win/loss ratio and divide it into two parts.
4. Select top 5 and bottom 5 teammates (or less if not possible).
5. If the player contains in the these lists, increase or decrease their rank from 1 to 5 depending on the place: for instance, the first player in the top 5 list receives +5 points, the last player in the bottom 5 list receives -5 points.

## Usage
1. Type list of players in ```input/list_of_users.txt```
2. Run script ```main.py```
3. See the results in the ```output``` folder.
4. See win/loss ratio for each player in the ```output/filtered_by_players/[username]_wl_by_players.tsv```
5. Parsing and calculations take 11s per player in average.

The tables structure:

symbol | description
-|-
W | number of wins
L | number of losses
W/L | win/loss ratio
% | percentage
\# | count (speedruns included)
2p | 2-player games
3p+ | 3-6 player games
